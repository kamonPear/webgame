<div class="login-page-container">
  <header class="page-header">
    <span class="logo-top">GamePoint</span>
    <span class="page-title">Sign Up</span>
  </header>

  <main class="main-content">
    <div class="character-image-container">
      <img src="assets\images\Photoroom.png" alt="Register Character Image" />
    </div>

    <div class="info-pane">
      <mat-card class="info-card">
        <h3>ขั้นตอนง่ายๆ ในการเข้าร่วม สมาชิก GamePoint</h3>
        <ol class="steps-list">
          <li>ลงทะเบียนโดยชื่อผู้ใช้, อีเมล, รหัสผ่าน</li>
          <li>เลือกรูปโปรไฟล์</li>
          <li>กรอกแบบฟอร์มสมัครสมาชิกให้เรียบร้อย</li>
          <li>กรุณาคลิกปุ่มสร้างบัญชี</li>
        </ol>
        <button mat-flat-button class="create-account-btn" routerLink="/login">เข้าสู่ระบบ</button>
      </mat-card>
    </div>

    <div class="login-pane">
      <mat-card class="login-card">
        <mat-card-content>
          <input type="file" #fileInput hidden (change)="onFileSelected($event)" accept="image/*" />

          <div class="profile-pic-container">
            <img
              *ngIf="imagePreview"
              [src]="imagePreview"
              class="profile-pic-preview"
              (click)="fileInput.click()"
              alt="Profile Preview"
            />
            <button
              *ngIf="!imagePreview"
              mat-fab
              class="profile-pic-btn"
              (click)="fileInput.click()"
              aria-label="Upload profile picture"
            >
              <mat-icon>photo_camera</mat-icon>
            </button>
          </div>

          <h2 class="login-title">สมัครสมาชิก</h2>

          <form [formGroup]="registerForm" (ngSubmit)="onSubmit()">
            <mat-form-field appearance="fill" class="login-field">
              <mat-icon matPrefix>person</mat-icon>
              <mat-label>ชื่อผู้ใช้</mat-label>
              <input matInput formControlName="username" placeholder="Username" required />
              <mat-error *ngIf="registerForm.get('username')?.hasError('required')">
                กรุณากรอกชื่อผู้ใช้
              </mat-error>
              <mat-error *ngIf="registerForm.get('username')?.hasError('minlength')">
                ชื่อผู้ใช้ต้องมีอย่างน้อย 4 ตัวอักษร
              </mat-error>
            </mat-form-field>

            <mat-form-field appearance="fill" class="login-field">
              <mat-icon matPrefix>mail</mat-icon>
              <mat-label>อีเมล</mat-label>
              <input matInput formControlName="email" placeholder="Email" type="email" required />
              <mat-error *ngIf="registerForm.get('email')?.hasError('required')">
                กรุณากรอกอีเมล
              </mat-error>
              <mat-error *ngIf="registerForm.get('email')?.hasError('email')">
                รูปแบบอีเมลไม่ถูกต้อง
              </mat-error>
            </mat-form-field>

            <mat-form-field appearance="fill" class="login-field">
              <mat-icon matPrefix>lock</mat-icon>
              <mat-label>รหัสผ่าน</mat-label>
              <input
                matInput
                formControlName="password"
                [type]="hidePassword ? 'password' : 'text'"
                placeholder="Password"
                required
              />
              <button
                type="button"
                mat-icon-button
                matSuffix
                (click)="hidePassword = !hidePassword"
                aria-label="Toggle password visibility"
              >
                <mat-icon>{{ hidePassword ? 'visibility_off' : 'visibility' }}</mat-icon>
              </button>
              <mat-error *ngIf="registerForm.get('password')?.hasError('required')">
                กรุณากรอกรหัสผ่าน
              </mat-error>
              <mat-error *ngIf="registerForm.get('password')?.hasError('minlength')">
                รหัสผ่านต้องมีอย่างน้อย 6 ตัวอักษร
              </mat-error>
            </mat-form-field>

            <div *ngIf="registerError" class="error-message">
              {{ registerError }}
            </div>

            <div class="actions">
              <button
                mat-flat-button
                type="submit"
                class="login-btn"
                [disabled]="registerForm.invalid"
              >
                สร้างบัญชี
              </button>
            </div>
          </form>
        </mat-card-content>
      </mat-card>
    </div>
  </main>

  <h3 class="footer-text">คุณพร้อมแล้ว เริ่มสนุกกับการช็อปปิ้งใน GamePoint ตอนนี้</h3>
</div>
